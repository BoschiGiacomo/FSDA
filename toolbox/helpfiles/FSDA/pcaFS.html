<!DOCTYPE HTML> <html itemscope="" xmlns="http://www.w3.org/1999/xhtml"><head><title>pcaFS</title><meta content="refpage" name="chunktype"><meta content="function:pcaFS" itemprop="refentity" name="refentity"><meta content="text/javascript" http-equiv="Content-Script-Type"><meta content="fcn" itemprop="pagetype" name="toctype"><meta content="ref/function" itemprop="infotype" name="infotype" /><meta content="pcaFS performs Principal Component Analysis (PCA) on raw data.." itemprop="description" name="description" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7" /><script type="text/x-mathjax-config">MathJax.Hub.Config({extensions: ["tex2jax.js"],jax: ["input/TeX","output/HTML-CSS"],menuSettings: {zoom: "Double-Click", zscale: "300"},tex2jax: {inlineMath: [["$","$"],["\\(","\\)"]]},MathMenu: {showRenderer: false},"HTML-CSS": {availableFonts: ["TeX"],preferredFont: "TeX",imageFont: null}});</script><script type="text/javascript" src="includesFS/Mathjax/MathJax.js"></script><script src="includesFS/matlab-highlighter.min.js"></script><link href="includesFS/matlab-highlighter.css" rel="stylesheet" type="text/css"><script type="text/javascript" src="includesFS/jquery-latest.js"></script><script>$(document).ready(function(){      $("#divtop").load("includesFS/top.html");      $("#divbottom").load("includesFS/bottom.html");});</script><link href="../includes/product/css/bootstrap.min.css" rel="stylesheet" type="text/css"></link><link href="../includes/product/css/site6.css" rel="stylesheet" type="text/css"></link><link href="../includes/product/css/site6_lg.css" rel="stylesheet" media="screen and (min-width: 1200px)"></link><link href="../includes/product/css/site6_md.css" rel="stylesheet" media="screen and (min-width: 992px) and (max-width: 1199px)"></link><link href="../includes/product/css/site6_sm+xs.css" rel="stylesheet" media="screen and (max-width: 991px)"></link><link href="../includes/product/css/site6_sm.css" rel="stylesheet" media="screen and (min-width: 768px) and (max-width: 991px)"></link><link href="../includes/product/css/site6_xs.css" rel="stylesheet" media="screen and (max-width: 767px)"></link><link href="../includes/product/css/site6_offcanvas.css" rel="stylesheet" type="text/css"></link><script src="../includes/shared/scripts/l10n.js" type="text/javascript"></script><script src="../includes/product/scripts/docscripts.js"></script><script src="../includes/shared/scripts/docscripts_rn.js"></script><script src="../includes/shared/scripts/mw.imageanimation.js" type="text/javascript"></script><script src="../includes/shared/scripts/jquery.highlight.js"></script><script src="../includes/product/scripts/bootstrap.min.js" type="text/javascript"></script><script src="../includes/product/scripts/global.js"></script><script src="includesFS/bottom.js" type="text/javascript"></script><script src="../includes/product/scripts/underscore-min.js"></script><script src="../includes/shared/scripts/f1help.js" type="text/javascript"></script><script src="../includes/product/scripts/suggest.js" type="text/javascript"></script><script src="../includes/shared/scripts/helpservices.js" type="text/javascript"></script><script src="../includes/product/scripts/jquery/jquery.mobile.custom.min.js"></script><!-- the following line should be kept this way only --><link href="includesFS/doc_center.css" rel="stylesheet" type="text/css"></link><link href="../includes/product/css/doc_center_installed.css" rel="stylesheet" type="text/css"><link href="../includes/product/css/doc_center_print.css" media="print" rel="stylesheet" type="text/css"></head><body  onload="highlightMATLABCode();" id="responsive_offcanvas">  <div id="doc_header_spacer" class="header"></div><div class="sticky_header_container includes_subnav"><div class="section_header level_3"><div class="container-fluid"><div class="row" id="mobile_search_row"><div class="col-xs-12 col-sm-6 col-sm-push-6 col-md-5 col-md-push-7" id="mobile_search"><div class="search_nested_content_container"><form id="docsearch_form" name="docsearch_form" method="get" data-release="R2017a" data-language="en" action="../templates/searchresults.html"><div class="input-group tokenized_search_field"><label class="sr-only">Search Help</label><input type="text" class="form-control conjoined_search" autocomplete="off" name="qdoc" placeholder="Search Help" id="docsearch"><div class="input-group-btn"><button type="submit" name="submitsearch" id="submitsearch" class="btn icon-search btn_search_adjacent btn_search icon_16" tabindex="-1"></button></div></div></form></div><button class="btn icon-remove btn_search pull-right icon_32 visible-xs" data-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div><div class="col-sm-6 col-sm-pull-6 col-md-7 col-md-pull-5" id="section_header_title"><div class="section_header_content"><div class="section_header_title"><h1><a href="../documentation-center.html">Documentation</a></h1></div></div></div><div class="visible-xs" id="search_actuator"><button class="btn icon-search btn_search pull-right icon_16" data-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div></div><!--END.CLASS row--> </div><!--END.CLASS container-fluid--> </div><!--END.CLASS section_header level_3--><div class="horizontal_nav"><div class="horizontal_nav_container"><div class="offcanvas_actuator" data-toggle="offcanvas" data-target="#sidebar" id="nav_toggle"><button type="button" class="btn"><span class="sr-only">Toggle navigation</span><span class="icon-menu icon_24"></span></button><span class="offcanvas_actuator_label"></span><span class="offcanvas_actuator_close"></span> </div><div class="offcanvas_horizontal_nav"><div class="container-fluid"><div class="row"><div class="col-md-12 hidden-xs hidden-sm"></div></div></div></div></div></div></div><!--END.CLASS sticky_header_container--><div class="row-offcanvas row-offcanvas-left"><div id="sidebar" class="sidebar-offcanvas" role="navigation"><nav class="offcanvas_nav" role="navigation"><ul class="nav_breadcrumb" xmlns:atict="http://www.arbortext.com/namespace/atict"><li itemprop="breadcrumb" itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb"> <a href="../documentation-center.html" itemprop="url"> <span itemprop="title">All Products</span></a></li></ul><ul class="nav_disambiguation" xmlns:atict="http://www.arbortext.com/namespace/atict"><li class="product"><a href="index.html">Flexible Statistics and Data Analysis (FSDA)</a><div class="dropdown"> <span id="dropdownMenu1" class="icon-arrow-down icon_16" data-toggle="dropdown"> </span><ul aria-labelledby="dropdownMenu1" class="dropdown-menu dropdown-menu-right" role="menu"><li role="presentation"> <a href="examples.html" role="menuitem" tabindex="-1">Examples</a></li><li role="presentation"> <a href="function-alpha.html" role="menuitem" tabindex="-1"> Functions and Other Reference</a></li><li role="presentation"> <a href="release_notes.html?s_cid=doc_flyout" role="menuitem" tabindex="-1"> Release Notes</a></li><li role="presentation"> <a href="tutorials.html" role="menuitem" tabindex="-1"> Tutorials</a></li></ul></div></li></ul><ul xmlns:atict="http://www.arbortext.com/namespace/atict" class="nav_disambiguation"> <li><a href="index.html">Flexible Statistics and Data Analysis Toolbox</a> </li> <li><a href="function-cate.html" itemprop="url">Functions</a></li></ul><!-- --><ul class="nav_scrollspy nav" xmlns:atict="http://www.arbortext.com/namespace/atict">  <li class="nav_scrollspy_function"> <a href="#responsive_offcanvas">pcaFS</a></li> <li id="SSPY810-refentry" class="nav_scrollspy_title">On this page</li><li><a class="intrnllnk" href="#syntax">Syntax</a></li><li><a class="intrnllnk" href="#Description">Description</a></li><li><a class="intrnllnk" href="#Examples">Examples</a><ul><li><a class="intrnllnk" href="#Example_1">Use of pcaFS with citiesItaly dataset.</a></li><li><a class="intrnllnk" href="#Example_2">Use of pcaFS on the ingredients dataset.</a></li></ul></li><li><a class="intrnllnk" href="#ExtraExamples">Extra Examples</a><ul><li><a class="intrnllnk" href="#ExtraExample_1">Use of pcaFS with option robust true.</a></li><li><a class="intrnllnk" href="#ExtraExample_2">Use of pcaFS with options Latitude and Longitude.</a></li><li><a class="intrnllnk" href="#ExtraExample_3">Use of pcaFS with option ShapeFile.</a></li></ul></li><li><a class="intrnllnk" href="#Inputs">Input Arguments</a><ul><li><a class="intrnllnk" href="#input_argument_Y">Y</a></li></ul></li><li><a class="intrnllnk" href="#NameValuePairs">Name-Value Pair Arguments</a><ul><li><a class="intrnllnk" href="#input_argument_namevalue_biplot">biplot</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_dispresults">dispresults</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_Latitude">Latitude</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_Longitude">Longitude</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_NumComponents">NumComponents</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_plots">plots</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_robust">robust</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_ShapeFile">ShapeFile</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_standardize">standardize</a></li></ul></li><li><a class="intrnllnk" href="#OutputArgs">Output Arguments</a><ul><li><a class="intrnllnk" href="#output_argument_out">out</a></li></ul></li><li><a class="intrnllnk" href="#References">References</a></li><li><a class="intrnllnk" href="#SeeAlso">See Also</a></li></ul></nav><script src="../includes/product/scripts/offcanvas.js"></script></div><div id="divtop"></div><div class="site_container site_toc_closed"><div class="page_container"><div class="content_frame"><div id="content_container" class="content_container"><section id="doc_center_content"><div class="function_ref"><div itemprop="content"><h1 itemprop="title">pcaFS</h1><div class="doc_topic_desc"><div class="purpose_container"><p itemprop="purpose">pcaFS performs Principal Component Analysis (PCA) on raw data.</p><div class="switch"><a id="expandAllPage" href="javascript:void(0);">expand all in page</a></div></div></div></div><div class="ref_sect"><h2 id="syntax">Syntax</h2><div class="syntax_signature"><div class="syntax_signature_module"><ul><li><code class="synopsis">out=pcaFS(Y)</code><span class="syntax_example"><a class="intrnllnk" href="pcaFS.html#Example_1">example</a></span></li><li><code class="synopsis">out=pcaFS(Y,Name,Value)</code><span class="syntax_example"><a class="intrnllnk" href="pcaFS.html#Example_2">example</a></span></li></ul></div></div></div>	<div class="ref_sect" itemprop="content">							<h2 id="Description">Description</h2>							<div class="descriptions">								<div class="description_module"><p><p>The main differences with respect to MATLAB function pca are:
   1) accepts an input X also as table;</p> <p>
   2) produces in table format the percentage of the variance explained
      single and cumulative of the various components and the associated
      scree plot, in order to decide about the number of components to
      retain.</p> <p>
   3) returns the loadings in table format and shows them graphically.</p> <p>
   4) provides guidelines about the automatic choice of the number of
       components;</p> <p>
   5) returns the communalities for each variable with respect to the
       first k principal components in table format;</p><p>
   6) retuns the orthogonal distance ($OD_i$) of each observation to the
      PCA subspace. For example, if the subspace is defined by the first two
      principal components, $OD_i$ is computed as:
      </p>\[
        OD_i=|| z_i- V_{(2)} V_{(2)}' z_i ||
      \]<p>
      where z_i is the i-th row of the original centered data matrix $Z$ of
      dimension $n \times v$ and $V_{(2)}=(v_1 v_2)$ is the matrix of size
      $p \times 2$ containing the first two eigenvectors of $Z'Z/(n-1)$. The
      observations with large $OD_i$ are not well represented in the space of
      the principal components.</p> <p>
   7)  returns the score distance $SD_i$ of each observation. For example,
      if the subspace is defined by the first two principal components,
      $SD_i$ is computed as:
      </p>\[
        SD_i=\sqrt{(z_i'v_1)^2/l_1+ (z_i'v_2)^2/l_2 }
      \]<p>
      where $l_1$ and $l_2$ are the first two eigenvalues of $Z'Z/(n-1)$.</p> <p>
   8) calls app biplotFS which enables to obtain an interactive biplot in
      which points, rowslabels or arrows can be shown or hidden. This app
      also gives the possibility of controlling the length of the arrows
      and the position of the row points through two interactive slider
      bars. In the app it is also possible to color row points depending
      on the orthogonal distance ($OD_i$) of each observation to the PCA
      subspace. If optional input argument bsb or bdp is specified, it is
      possible to have in the app two tabs which enable the user to select
      the breakdown point of the analysis or the subset size to use in the
      svd. The units which are declared as outliers or the units outside
      the subset are shown in the biplot with filled circles.</p></p><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="pcaFS.html#Example_1">	example</a></p>	<p><span itemprop="syntax"><code><a class="intrnllnk" href="#outputarg_out"><code>out</code></a>=pcaFS(<a class="intrnllnk" href="#inputarg_Y"><code>Y</code></a>)</code></span>Use of pcaFS with citiesItaly dataset.</p></div><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="pcaFS.html#Example_2">	example</a></p>	<p><span itemprop="syntax"><code><a class="intrnllnk" href="#outputarg_out"><code>out</code></a>=pcaFS(<a class="intrnllnk" href="#inputarg_Y"><code>Y</code></a>,<a class="intrnllnk" href="#namevaluepairarguments"><code>Name, Value</code></a>)</code></span>Use of pcaFS on the ingredients dataset.</p></div>								</div>							</div>							<div class="clear">							</div>						</div><div class="ref_sect" itemprop="content"><div class="examples"><h2 id="Examples">Examples</h2><div id="expandableExamples" class="expandableContent"><p class="switch"><a class="expandAllLink"href="javascript:void(0);">expand all</a></p><div id="example_1" class="example_module expandableContent"><div id="Example_1"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li>Use of pcaFS with citiesItaly dataset.</li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code">load citiesItaly;
% Use all default options
out=pcaFS(citiesItaly);</pre></div></div></p></div></div><div id="example_2" class="example_module expandableContent"><div id="Example_2"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li><img alt="" src="images_help/M.gif" style="width: 12px; height: 12px"> Use of pcaFS on the ingredients dataset.</li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code">load hald
% Operate on the covariance matrix.
out=pcaFS(ingredients,'standardize',false,'biplot',0);</pre></div></div><pre class="codeoutput">The first PC already explains more than 0.95^v variability
In what follows we still extract the first 2 PCs
Initial covariance matrix
           Y1       Y2       Y3       Y4  
          _____    _____    _____    _____

    Y1     1.00     0.23    -0.82    -0.25
    Y2     0.23     1.00    -0.14    -0.97
    Y3    -0.82    -0.14     1.00     0.03
    Y4    -0.25    -0.97     0.03     1.00

Explained variance by PCs
           Eigenvalues    Explained_Variance    Explained_Variance_cum
           ___________    __________________    ______________________

    PC1      517.80             86.60                    86.60        
    PC2       67.50             11.29                    97.89        
    PC3       12.41              2.07                    99.96        
    PC4        0.24              0.04                   100.00        

Loadings = correlations between variables and PCs
           PC1       PC2 
          ______    _____

    Y1      1.54     5.31
    Y2     15.44     0.16
    Y3     -0.66    -6.21
    Y4    -16.63     0.89

Communalities
           PC1       PC2     PC1-PC2
          ______    _____    _______

    Y1      2.38    28.17     30.55 
    Y2    238.39     0.03    238.41 
    Y3      0.44    38.51     38.94 
    Y4    276.60     0.79    277.39 

Units with the 5 largest values of (combined) score and orthogonal distance
    10     1     7     8    11

</pre><a href='http://rosa.unipr.it/fsda/pcaFS.html#Example_2'><img vspace="5" hspace="5" src="images\pcaFS_01.png" alt="Click here for the graphical output of this example (link to Ro.S.A. website)."> <img vspace="5" hspace="5" src="images\pcaFS_02.png" alt=""> <img vspace="5" hspace="5" src="images\pcaFS_03.png" alt=""> </a></p></div></div></div><p> </p><div class="examples"><h2 id="ExtraExamples" class="bottom_ruled">Related Examples</h2><div id="expandableExamples" class="expandableContent"><p class="switch"><a class="expandAllLink"href="javascript:void(0);">expand all</a></p><div id="Extraexample_1" class="example_module expandableContent"><div id="ExtraExample_1"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li><img alt="" src="images_help/M.gif" style="width: 12px; height: 12px"> Use of pcaFS with option robust true.</li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code">load citiesItaly;
% Use all default options
out=pcaFS(citiesItaly,'robust',true);</pre></div></div><pre class="codeoutput">Initial correlation matrix
                  addedval    depos    pensions    unemploy    export    bankrup    billsoverd
                  ________    _____    ________    ________    ______    _______    __________

    addedval        1.00       0.91      0.73       -0.82       0.59      -0.04       -0.49   
    depos           0.91       1.00      0.70       -0.79       0.53      -0.03       -0.49   
    pensions        0.73       0.70      1.00       -0.52       0.35       0.24       -0.46   
    unemploy       -0.82      -0.79     -0.52        1.00      -0.61       0.18        0.43   
    export          0.59       0.53      0.35       -0.61       1.00       0.07       -0.21   
    bankrup        -0.04      -0.03      0.24        0.18       0.07       1.00        0.38   
    billsoverd     -0.49      -0.49     -0.46        0.43      -0.21       0.38        1.00   

Explained variance by PCs
           Eigenvalues    Explained_Variance    Explained_Variance_cum
           ___________    __________________    ______________________

    PC1       3.97              56.75                    56.75        
    PC2       1.31              18.76                    75.51        
    PC3       0.80              11.45                    86.97        
    PC4       0.45               6.36                    93.32        
    PC5       0.22               3.10                    96.42        
    PC6       0.17               2.43                    98.85        
    PC7       0.08               1.15                   100.00        

Loadings = correlations between variables and PCs
                   PC1      PC2 
                  _____    _____

    addedval      -0.95    -0.06
    depos         -0.93    -0.05
    pensions      -0.77    -0.30
    unemploy       0.88    -0.09
    export        -0.67    -0.21
    bankrup        0.07    -0.95
    billsoverd     0.61    -0.52

Communalities
                  PC1     PC2     PC1-PC2
                  ____    ____    _______

    addedval      0.91    0.00     0.91  
    depos         0.86    0.00     0.87  
    pensions      0.60    0.09     0.69  
    unemploy      0.77    0.01     0.78  
    export        0.45    0.04     0.49  
    bankrup       0.01    0.89     0.90  
    billsoverd    0.38    0.27     0.65  

Units with the 5 largest values of (combined) score and orthogonal distance
    65    17    70    99    76

</pre><a href='http://rosa.unipr.it/fsda/pcaFS.html#ExtraExample_1'><img vspace="5" hspace="5" src="images\pcaFS_04.png" alt="Click here for the graphical output of this example (link to Ro.S.A. website)"> <img vspace="5" hspace="5" src="images\pcaFS_05.png" alt=""> <img vspace="5" hspace="5" src="images\pcaFS_06.png" alt=""> <img vspace="5" hspace="5" src="images\pcaFS_07.png" alt=""> </a></p></div></div><div id="Extraexample_2" class="example_module expandableContent"><div id="ExtraExample_2"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li><img alt="" src="images_help/M.gif" style="width: 12px; height: 12px"> Use of pcaFS with options Latitude and Longitude.</li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code">load citiesItaly2024.mat
X=citiesItaly2024;
% Retrieve Latitude and Longitude of each province
LatLong=X.Properties.UserData{2};
Latitude=LatLong(:,1);
Longitude=LatLong(:,2);
out=pcaFS(X,'Latitude',Latitude,'Longitude',Longitude);</pre></div></div><pre class="codeoutput">The first PC already explains more than 0.95^v variability
In what follows we still extract the first 2 PCs
Initial correlation matrix
                 Deposit    Bankrup    UrbanFra    Paym30D    ElecPar    QualLif    Protest    SalaryA    SpendingA    Employm    AddedVa    LowISEE
                 _______    _______    ________    _______    _______    _______    _______    _______    _________    _______    _______    _______

    Deposit        1.00      -0.33      -0.70        0.72       0.58       0.76      -0.14       0.74        0.75        0.79       0.79      -0.76 
    Bankrup       -0.33       1.00       0.26       -0.39      -0.13      -0.44       0.33      -0.18       -0.22       -0.32      -0.24       0.40 
    UrbanFra      -0.70       0.26       1.00       -0.77      -0.74      -0.74       0.23      -0.74       -0.81       -0.90      -0.70       0.83 
    Paym30D        0.72      -0.39      -0.77        1.00       0.69       0.81      -0.35       0.74        0.79        0.80       0.63      -0.82 
    ElecPar        0.58      -0.13      -0.74        0.69       1.00       0.58      -0.16       0.64        0.78        0.73       0.55      -0.62 
    QualLif        0.76      -0.44      -0.74        0.81       0.58       1.00      -0.37       0.70        0.77        0.83       0.72      -0.86 
    Protest       -0.14       0.33       0.23       -0.35      -0.16      -0.37       1.00      -0.14       -0.31       -0.31      -0.11       0.39 
    SalaryA        0.74      -0.18      -0.74        0.74       0.64       0.70      -0.14       1.00        0.85        0.80       0.86      -0.66 
    SpendingA      0.75      -0.22      -0.81        0.79       0.78       0.77      -0.31       0.85        1.00        0.92       0.78      -0.79 
    Employm        0.79      -0.32      -0.90        0.80       0.73       0.83      -0.31       0.80        0.92        1.00       0.81      -0.86 
    AddedVa        0.79      -0.24      -0.70        0.63       0.55       0.72      -0.11       0.86        0.78        0.81       1.00      -0.68 
    LowISEE       -0.76       0.40       0.83       -0.82      -0.62      -0.86       0.39      -0.66       -0.79       -0.86      -0.68       1.00 

Explained variance by PCs
            Eigenvalues    Explained_Variance    Explained_Variance_cum
            ___________    __________________    ______________________

    PC 1       8.02              66.82                    66.82        
    PC 2       1.29              10.77                    77.60        
    PC 3       0.77               6.45                    84.05        
    PC 4       0.52               4.37                    88.42        
    PC 5       0.36               3.00                    91.42        
    PC 6       0.27               2.24                    93.66        
    PC 7       0.24               1.98                    95.64        
    PC 8       0.17               1.44                    97.08        
    PC 9       0.13               1.04                    98.12        
    PC10       0.10               0.82                    98.94        
    PC11       0.09               0.73                    99.66        
    PC12       0.04               0.34                   100.00        

Loadings = correlations between variables and PCs
                  PC1      PC2 
                 _____    _____

    Deposit      -0.86    -0.10
    Bankrup       0.38    -0.69
    UrbanFra      0.89     0.10
    Paym30D      -0.89     0.11
    ElecPar      -0.77    -0.22
    QualLif      -0.89     0.18
    Protest       0.34    -0.73
    SalaryA      -0.86    -0.27
    SpendingA    -0.93    -0.12
    Employm      -0.96    -0.04
    AddedVa      -0.84    -0.24
    LowISEE       0.90    -0.17

Communalities
                 PC1     PC2     PC1-PC2
                 ____    ____    _______

    Deposit      0.73    0.01     0.74  
    Bankrup      0.15    0.47     0.62  
    UrbanFra     0.80    0.01     0.81  
    Paym30D      0.79    0.01     0.80  
    ElecPar      0.59    0.05     0.64  
    QualLif      0.80    0.03     0.83  
    Protest      0.11    0.53     0.65  
    SalaryA      0.74    0.07     0.82  
    SpendingA    0.86    0.01     0.88  
    Employm      0.91    0.00     0.92  
    AddedVa      0.71    0.06     0.76  
    LowISEE      0.82    0.03     0.85  

Units with the 5 largest values of (combined) score and orthogonal distance
    15    21    89    58    60

</pre><a href='http://rosa.unipr.it/fsda/pcaFS.html#ExtraExample_2'><img vspace="5" hspace="5" src="images\pcaFS_08.png" alt="Click here for the graphical output of this example (link to Ro.S.A. website)"> <img vspace="5" hspace="5" src="images\pcaFS_09.png" alt=""> <img vspace="5" hspace="5" src="images\pcaFS_10.png" alt=""> <img vspace="5" hspace="5" src="images\pcaFS_11.png" alt=""> <img vspace="5" hspace="5" src="images\pcaFS_12.png" alt=""> </a></p></div></div><div id="Extraexample_3" class="example_module expandableContent"><div id="ExtraExample_3"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li><img alt="" src="images_help/M.gif" style="width: 12px; height: 12px"> Use of pcaFS with option ShapeFile.</li></span></a></span></h3><div class="collapse"><p>
     Note that this option requires the Mapping Toolbox to be installed.<div class="programlisting"><div class="codeinput"><pre class="matlab-code">a=struct2table(ver);
MappingInstalled=any(string(a{:,1})=="Mapping Toolbox");
if MappingInstalled ==true
load citiesItaly2024.mat
X=citiesItaly2024;
ShapeFile=X.Properties.UserData{1};
out=pcaFS(X,"ShapeFile",ShapeFile,'biplot',0);
else
disp('This option requires that the "mapping toolbox" is installed') 
end</pre></div></div><pre class="codeoutput">The first PC already explains more than 0.95^v variability
In what follows we still extract the first 2 PCs
Initial correlation matrix
                 Deposit    Bankrup    UrbanFra    Paym30D    ElecPar    QualLif    Protest    SalaryA    SpendingA    Employm    AddedVa    LowISEE
                 _______    _______    ________    _______    _______    _______    _______    _______    _________    _______    _______    _______

    Deposit        1.00      -0.33      -0.70        0.72       0.58       0.76      -0.14       0.74        0.75        0.79       0.79      -0.76 
    Bankrup       -0.33       1.00       0.26       -0.39      -0.13      -0.44       0.33      -0.18       -0.22       -0.32      -0.24       0.40 
    UrbanFra      -0.70       0.26       1.00       -0.77      -0.74      -0.74       0.23      -0.74       -0.81       -0.90      -0.70       0.83 
    Paym30D        0.72      -0.39      -0.77        1.00       0.69       0.81      -0.35       0.74        0.79        0.80       0.63      -0.82 
    ElecPar        0.58      -0.13      -0.74        0.69       1.00       0.58      -0.16       0.64        0.78        0.73       0.55      -0.62 
    QualLif        0.76      -0.44      -0.74        0.81       0.58       1.00      -0.37       0.70        0.77        0.83       0.72      -0.86 
    Protest       -0.14       0.33       0.23       -0.35      -0.16      -0.37       1.00      -0.14       -0.31       -0.31      -0.11       0.39 
    SalaryA        0.74      -0.18      -0.74        0.74       0.64       0.70      -0.14       1.00        0.85        0.80       0.86      -0.66 
    SpendingA      0.75      -0.22      -0.81        0.79       0.78       0.77      -0.31       0.85        1.00        0.92       0.78      -0.79 
    Employm        0.79      -0.32      -0.90        0.80       0.73       0.83      -0.31       0.80        0.92        1.00       0.81      -0.86 
    AddedVa        0.79      -0.24      -0.70        0.63       0.55       0.72      -0.11       0.86        0.78        0.81       1.00      -0.68 
    LowISEE       -0.76       0.40       0.83       -0.82      -0.62      -0.86       0.39      -0.66       -0.79       -0.86      -0.68       1.00 

Explained variance by PCs
            Eigenvalues    Explained_Variance    Explained_Variance_cum
            ___________    __________________    ______________________

    PC 1       8.02              66.82                    66.82        
    PC 2       1.29              10.77                    77.60        
    PC 3       0.77               6.45                    84.05        
    PC 4       0.52               4.37                    88.42        
    PC 5       0.36               3.00                    91.42        
    PC 6       0.27               2.24                    93.66        
    PC 7       0.24               1.98                    95.64        
    PC 8       0.17               1.44                    97.08        
    PC 9       0.13               1.04                    98.12        
    PC10       0.10               0.82                    98.94        
    PC11       0.09               0.73                    99.66        
    PC12       0.04               0.34                   100.00        

Loadings = correlations between variables and PCs
                  PC1      PC2 
                 _____    _____

    Deposit      -0.86    -0.10
    Bankrup       0.38    -0.69
    UrbanFra      0.89     0.10
    Paym30D      -0.89     0.11
    ElecPar      -0.77    -0.22
    QualLif      -0.89     0.18
    Protest       0.34    -0.73
    SalaryA      -0.86    -0.27
    SpendingA    -0.93    -0.12
    Employm      -0.96    -0.04
    AddedVa      -0.84    -0.24
    LowISEE       0.90    -0.17

Communalities
                 PC1     PC2     PC1-PC2
                 ____    ____    _______

    Deposit      0.73    0.01     0.74  
    Bankrup      0.15    0.47     0.62  
    UrbanFra     0.80    0.01     0.81  
    Paym30D      0.79    0.01     0.80  
    ElecPar      0.59    0.05     0.64  
    QualLif      0.80    0.03     0.83  
    Protest      0.11    0.53     0.65  
    SalaryA      0.74    0.07     0.82  
    SpendingA    0.86    0.01     0.88  
    Employm      0.91    0.00     0.92  
    AddedVa      0.71    0.06     0.76  
    LowISEE      0.82    0.03     0.85  

Units with the 5 largest values of (combined) score and orthogonal distance
    15    21    89    58    60

</pre><a href='http://rosa.unipr.it/fsda/pcaFS.html#ExtraExample_3'><img vspace="5" hspace="5" src="images\pcaFS_13.png" alt="Click here for the graphical output of this example (link to Ro.S.A. website)"> <img vspace="5" hspace="5" src="images\pcaFS_14.png" alt=""> <img vspace="5" hspace="5" src="images\pcaFS_15.png" alt=""> <img vspace="5" hspace="5" src="images\pcaFS_16.png" alt=""> </a></p></div></div></div></div></div><div class="ref_sect" itemprop="content"><h2 id="Inputs">Input Arguments</h2><div class="expandableContent"><div class="arguments"><div class="input_argument_container"><p class="switch"><a class="expandAllLink" href="javascript:void(0);">expand all</a></p><div class="expandableContent"> <div id="inputarg_Y" class="clearfix"> </div> <h3 id="input_argument_Y" class="expand"> <span> <a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"> <span class="argument_name"><code>Y</code> &#8212; Input data. </span>  </a><span class="example_desc">2D array or table.</span></span></h3> <div class="collapse"> <p><p>n x p data matrix; n observations and p variables. Rows of
               Y represent observations, and columns represent variables.</p> <p>
               Missing values (NaN's) and infinite values (Inf's) are
               allowed, since observations (rows) with missing or infinite
               values will automatically be excluded from the
               computations.</p><p>
                </p></p> <p class="datatypelist"><strong> Data Types: </strong><code>single|double</code></p> </div> </div><div id="namevaluepairarguments" class="clearfix"></div><h3 id="NameValuePairs" class="bottom_ruled">Name-Value Pair Arguments</h3><div class="namevaluecontainer"><p>Specify optional comma-separated pairs of <code>Name,Value</code> arguments. <code>Name</code> is the argument name and <code>Value</code> is the corresponding value. <code>Name</code> must appear  inside single quotes (<code>' '</code>).  You can specify several name and value pair arguments in any order as <code>  Name1,Value1,...,NameN,ValueN</code>.</p>  <span class="example_desc"><strong>Example:</strong><code><code> 'biplot',0
</code>,<code> 'dispresults',false
</code>,<code> 'Latitude',[54 43.2 ... 47]
</code>,<code> 'Longitude',[54 43.2 ... 47]
</code>,<code> 'NumComponents',2
</code>,<code> 'plots',0
</code>,<code> 'bsb',[2 10:90 93]
</code>,<code> 'ShapeFile','shapefileName'
</code>,<code> 'standardize',false
</code></code></span></div><div class="expandableContent"><div id="inputarg_biplot" class="clearfix"></div><h3 id="input_argument_namevalue_biplot" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>biplot</code> &#8212;launch app biplotFS.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>If biplot is 1
                   (default) app biplotFS is automatically launched. With
                   this app it is possible to show in a dynamic way the
                   rows points (PC coordinates), the arrows, the row
                   labels and control with a scrolling bar the length of
                   the arrows and the spread of row points.</p> <p>
                   </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'biplot',0
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_dispresults" class="clearfix"></div><h3 id="input_argument_namevalue_dispresults" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>dispresults</code> &#8212;show the results in the command window.</span></a><span class="example_desc">if dispresults                   is true, the percentage of variance explained together                   with the loadings, the criteria for deciding the number                   of components to retain and the 5 units with the                   largest score and orthogonal distance (combined) are                   shown in the command window.</span></span></h3><div class="collapse">	<p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'dispresults',false
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>char</code></p></div></div><div class="expandableContent"><div id="inputarg_Latitude" class="clearfix"></div><h3 id="input_argument_namevalue_Latitude" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>Latitude</code> &#8212;Latitude coordinates in degrees of the rows.</span></a><span class="example_desc">nx1 vector containint the                   numerical values of latitudes for each row.</span></span></h3><div class="collapse">	<p><p>If vectors Latitude and Longitude are present once
                   brushing of the units in biplotAPP is done, the
                   geobubble of the brushed units automatically
                   appears. The size of the bubble is proportional to the
                   value of the first principal component while the color
                   of the bubbles depends on the value of the second
                   principal component.</p> <p>
                   </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'Latitude',[54 43.2 ... 47]
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>vector with elements in the range [–90, 90]</code></p></div></div><div class="expandableContent"><div id="inputarg_Longitude" class="clearfix"></div><h3 id="input_argument_namevalue_Longitude" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>Longitude</code> &#8212;Longitude coordinates in degrees of the rows.</span></a><span class="example_desc">nx1 vector containint the                   numerical values of latitudes for each row.</span></span></h3><div class="collapse">	<p><p>If vectors Latitude and Longitude are present once
                   brushing of the units in biplotAPP is done, the
                   geobubble of the brushed units automatically
                   appears. The size of the bubble is proportional to the
                   value of the first principal component while the color
                   of the bubbles depends on the value of the second
                   principal component.</p> <p>
                   </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'Longitude',[54 43.2 ... 47]
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>vector with elements in the range [–90, 90]</code></p></div></div><div class="expandableContent"><div id="inputarg_NumComponents" class="clearfix"></div><h3 id="input_argument_namevalue_NumComponents" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>NumComponents</code> &#8212;the number of components desired.</span></a><span class="example_desc">specified as a                  scalar integer $k$ satisfying $0 &lt; k \leq p$.</span></span></h3><div class="collapse">	<p><p>When
                  specified, pcaFS returns the first $k$ columns of
                  out.coeff and out.score. If NumComponents is not
                  specified pcaFS returns the minimum number of components
                  which cumulatively enable to explain a percentage of
                  variance which is equal at least to $0.95^p$. If this
                  threshold is exceeded already by the first PC, pcaFS
                  still returns the first two PCs.</p> <p>
                   </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'NumComponents',2
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>char</code></p></div></div><div class="expandableContent"><div id="inputarg_plots" class="clearfix"></div><h3 id="input_argument_namevalue_plots" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>plots</code> &#8212;plots on the screen.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>If plots is 1 (default) it is
                   possible to show on the screen the scree plot of the
                   variance explained, the plot of the loadings for the
                   first two PCs.</p> <p>
                   </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'plots',0
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_robust" class="clearfix"></div><h3 id="input_argument_namevalue_robust" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>robust</code> &#8212;robust principal components.</span></a><span class="example_desc">boolean | struct.</span></span></h3><div class="collapse">	<p>If
               robust is a scalar boolean equal to true (default), FS is
               applied and using a Bonferronized confidence level units
               are declared as outliers. If robust is a struct it is
               possible to choose between FS or MCD and the structure may
               contain the following fields:
   <table border="2" cellpadding="4" cellspacing="0" class="body"><colgroup><col width="20%"><col width="80%"></colgroup><thead><tr valign="top"><th valign="top">Value</th><th valign="top">Description</th></tr></thead><tr valign="top"><td><code>bsb</code></td><td><p><p>units forming subset on which to
                  compute the svd. bsb can be either a
                  numeric vector of length m (m&lt;=n) containing the list of the
                  units (e.g. 1:50) or a logical vector of length n
                  containing the true for the units which have to be used
                  in the calculation of svd. For example bsb=true(n,1),
                  bsb(13)=false; excludes from the svd unit number 13.</p> <p>
                  The other units are projected into this robust space.</p><p>
                  Note that is robust.bsb is supplied all the other
                  options are ignored.</p></p></td></tr><tr valign="top"><td><code>conflev</code></td><td><p><p>scalar in the interval (0 1) which contains
                   the confidence level to declare the units as outliers.</p> <p>
                   if robust.conflev is not specified or if it is missing
                   a 0.99 Bonferronized confidence level is used.</p></p></td></tr><tr valign="top"><td><code>class</code></td><td><p>class can be either 'FS' (default) or 'MCD' or 'MM'
                   in order to choose between Forward search, or minimum
                   covariance determinant or MM estimators.</p></td></tr><tr valign="top"><td><code>bdp</code></td><td><p><p>break down point to use in the 'FS' or 'MCD' estimator or in the
                   preliminary S estimator which is used to compute the MM.</p> <p>
                   The default is bdp=0.4; It measures the fraction of outliers the algorithm should
               resist. In this case any value greater than 0 but smaller
               or equal than 0.5 will do fine.</p></p></td></tr><tr valign="top"><td><code>eff</code></td><td><p>nominal efficiency to use for the MM estimator
                       (note that  this field is used just if robust.class
                       is 'MM')</p></td></tr></table></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'bsb',[2 10:90 93]
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double or logical</code></p></div></div><div class="expandableContent"><div id="inputarg_ShapeFile" class="clearfix"></div><h3 id="input_argument_namevalue_ShapeFile" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>ShapeFile</code> &#8212;name of ShapeFile or geospatial table containg shapes.</span></a><span class="example_desc">character | string | geotable.</span></span></h3><div class="collapse">	<p><p>Name of the ShapeFile containing the containing the
               geometric details of the rows. The ShapeFile, which is
               loaded using function readgeotable, must have n rows and
               the n rows must have the same order of the n rows of Y. The
               default value of shapefile is empty that is we assume that
               no shapefile is given. If ShapeFile is given an additional
               GUI containing the areas colored using
               the first PC is shown.</p> <p> 
                                  Remark: note that this option can be used just is the
               "Mapping toolbox" is installed.</p><p>

</p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'ShapeFile','shapefileName'
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>char or string or geotable.</code></p></div></div><div class="expandableContent"><div id="inputarg_standardize" class="clearfix"></div><h3 id="input_argument_namevalue_standardize" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>standardize</code> &#8212;standardize data.</span></a><span class="example_desc">boolean.</span></span></h3><div class="collapse">	<p><p>Boolean which specifies
               whether to standardize the variables, that is we operate on
               the correlation matrix (default) or simply remove column
               means (in this last case we operate on the covariance
               matrix).</p> <p>
                   </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'standardize',false
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>boolean</code></p></div></div></div></div></div></div><div class="ref_sect" itemprop="content"><h2 id="OutputArgs" >Output Arguments</h2><div class="expandableContent"><div class="arguments"><div class="output_argument_container"><p class="switch"><a class="expandAllLink" href="javascript:void(0);">expand all</a></p><div class="expandableContent"><div id="outputarg_out" class="clearfix"></div><h3 id="output_argument_out" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>out</code> &#8212; description</span></a><span class="example_desc">Structure</span></span></h3><div class="collapse"><p>Structure which contains the following fields<table border="2" cellpadding="4" cellspacing="0" class="body"><colgroup><col width="20%"><col width="80%"></colgroup><thead><tr valign="top"><th valign="top">Value</th><th valign="top">Description</th></tr></thead><tr valign="top"><td><code>Rtable</code></td><td><p>p-by-p correlation matrix in table format.</p></td></tr><tr valign="top"><td><code>class</code></td><td><p>character vector containing pcaFS.</p></td></tr><tr valign="top"><td><code>explained</code></td><td><p><p>p \times 3 matrix containing respectively
                1st col = eigenvalues;</p> <p>
                2nd col = Explained Variance (in percentage)
                3rd col = Cumulative Explained Variance (in percentage)</p></p></td></tr><tr valign="top"><td><code>explainedT</code></td><td><p>the same as out.explained but in table format.</p></td></tr><tr valign="top"><td><code>coeff</code></td><td><p><p>p-by-NumComponents matrix containing the ordered eigenvectors
           of the correlation (covariance matrix) in table format.</p> <p>
            First column is referred to first eigenvector ...</p><p>
            Note that out.coeff'*out.coeff= I_NumComponents.</p></p></td></tr><tr valign="top"><td><code>coeffT</code></td><td><p>the same as out.coeff but in table format.</p></td></tr><tr valign="top"><td><code>loadings</code></td><td><p>p-by-NumComponents matrix containing the correlation
             coefficients between the original variables and the first
             NumComponents principal components.</p></td></tr><tr valign="top"><td><code>loadingsT</code></td><td><p>the same as out.loadings but in table format.</p></td></tr><tr valign="top"><td><code>score</code></td><td><p>the principal component scores. The rows of out.score
            correspond to observations, columns to components. The
            covariance matrix of out.score is $\Lambda$ (the diagonal
            matrix containing the eigenvalues of the correlation
            (covariance matrix).</p></td></tr><tr valign="top"><td><code>scoreT</code></td><td><p>the same as outscore but in table format.</p></td></tr><tr valign="top"><td><code>communalities</code></td><td><p><p>matrix with p-by-2*NumComponents-1 columns.</p> <p>
               The first NumComponents columns contain the communalities
               (variance extracted) by the the first NumComponents
               principal components. Column NumComponents+1 contains the
               communalities extracted by the first two principal
               components. Column NumComponents+2 contains the
               communalities extracted by the first three principal
               components...</p></p></td></tr><tr valign="top"><td><code>communalitiesT</code></td><td><p>the same as out.communalities but in table format.</p></td></tr><tr valign="top"><td><code>orthDist</code></td><td><p><p>orthogonal distance from PCA subspace.</p> <p>
                 Column vector of length n containing the orthogonal
                 distance of each observation from the PCA subspace.</p></p></td></tr><tr valign="top"><td><code>scoreDist</code></td><td><p><p>score distance from centroid.</p> <p>
                 Column vector of length n containing the score
                 distance of each observation from the PCA subspace.</p> <p>
                 The analysis of out.orthDist and out.scoreDist reveals
                 the good leverage points, the orthogonal outliers and the
                 bad leverage points.</p> <p>
                 Good leverage points: points which lie close to the PCA
                 space but far from the regular observations. Good
                 leverage points have a large score distance and low
                 orthogonal distance. Orthogonal outliers are points which
                 have a large orthogonal distance to the PCA subspace but
                 cannot be seen when we look only at their projection on
                 the PCA subspace. Bad leverage points are points which
                 have a large orthogonal distance and whose projection on
                 the PCA subspace is remote from the typical projections.</p><p>
                 These points have a large score distance and a large
                 orthogonal distance.</p></p></td></tr></table></p></div></div></div></div></div></div><div class="ref_sect" itemprop="content"><div class="bibliography"><h2 id="References">References</h2> </div></div><div class="ref_sect"><h2 id="SeeAlso">See Also</h2><p><span itemprop="seealso"><a href="matlab:web(fullfile(docroot,'deeplearning/ref/neuronpca.html'))" itemprop="url"><span itemprop="name"><code>pca</code></span></a></span> | <span itemprop="seealso"><a href="biplotFS.html" itemprop="url"><span itemprop="name"><code>biplotFS</code></span></a></span></div><i>This page has been automatically generated by our routine <a href="publishFS.html">publishFS</a></i></div></section></div></div></div></div><div id="divbottom"></div></body></html>